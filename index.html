<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Riichi Mahjong Scorer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="app-container">
    <!-- Top Bar: Game Info -->
    <header class="game-info">
        <div class="info-item">
            <span id="round-display" style="font-weight: bold; font-size: 1.2em;">East 1</span>
        </div>
        <div class="info-item">
            <span data-i18n="riichiSticks">Riichi Sticks ðŸ€„</span>
            <span id="pot-sticks" class="highlight">0</span>
        </div>
        <div class="info-item">
            <span data-i18n="honba">Honba ðŸŽ´</span>
            <span id="honba-count" class="highlight">0</span>
        </div>
        <div style="display: flex; gap: 5px; align-items: center;">
            <select id="lang-select" onchange="changeLanguage(this.value)" style="padding: 5px; border-radius: 4px; background: #333; color: white; border: 1px solid #666;">
                <option value="en">English</option>
                <option value="ja">æ—¥æœ¬èªž</option>
                <option value="zh">ä¸­æ–‡</option>
            </select>
            <button class="btn-reset" onclick="rotateSeats()" data-i18n="rotate">Rotate â†»</button>
            <button class="btn-reset" onclick="shuffleSeats()" data-i18n="shuffle">Shuffle â¤®</button>
            <button class="btn-reset" onclick="resetGame()" data-i18n="reset">Reset Game</button>
        </div>
    </header>

    <!-- Players Grid -->
    <div class="players-grid">
        <div class="player-card" id="p0">
            <div class="player-header">
                <span class="wind" id="wind-0">East</span>
                <input type="text" class="player-name" placeholder="Player 1">
            </div>
            <div class="player-score" id="score-0">25000</div>
            <div class="player-actions">
                <button class="btn-riichi" data-i18n="riichi" onclick="declareRiichi(0)">Riichi</button>
            </div>
        </div>
        <div class="player-card" id="p1">
            <div class="player-header">
                <span class="wind" id="wind-1">South</span>
                <input type="text" class="player-name" placeholder="Player 2">
            </div>
            <div class="player-score" id="score-1">25000</div>
            <div class="player-actions">
                <button class="btn-riichi" data-i18n="riichi" onclick="declareRiichi(1)">Riichi</button>
            </div>
        </div>
        <div class="player-card" id="p3">
            <div class="player-header">
                <span class="wind" id="wind-3">North</span>
                <input type="text" class="player-name" placeholder="Player 4">
            </div>
            <div class="player-score" id="score-3">25000</div>
            <div class="player-actions">
                <button class="btn-riichi" data-i18n="riichi" onclick="declareRiichi(3)">Riichi</button>
            </div>
        </div>
        <div class="player-card" id="p2">
            <div class="player-header">
                <span class="wind" id="wind-2">West</span>
                <input type="text" class="player-name" placeholder="Player 3">
            </div>
            <div class="player-score" id="score-2">25000</div>
            <div class="player-actions">
                <button class="btn-riichi" data-i18n="riichi" onclick="declareRiichi(2)">Riichi</button>
            </div>
        </div>
    </div>

    <!-- Main Action Bar -->
    <footer class="action-bar">
        <button class="btn-action btn-win" onclick="openWinModal()" data-i18n="win">Win (Agari)</button>
        <button class="btn-action btn-draw" onclick="openDrawModal()" data-i18n="draw">Draw (Ryuukyoku)</button>
    </footer>
</div>

<!-- Win Modal -->
<div id="win-modal" class="modal hidden">
    <div class="modal-content">
        <h2 data-i18n="win">Record Win</h2>
        
        <div class="section">
            <label data-i18n="whoWon">Who Won?</label>
            <div class="toggle-group" id="winner-select"></div>
        </div>

        <div class="section">
            <label data-i18n="winType">Win Type</label>
            <div class="toggle-group">
                <button class="toggle-btn active" onclick="setWinType('ron')" id="btn-ron" data-i18n="ron">Ron</button>
                <button class="toggle-btn" onclick="setWinType('tsumo')" id="btn-tsumo" data-i18n="tsumo">Tsumo</button>
            </div>
        </div>

        <div class="section" id="loser-section">
            <label data-i18n="whoDealt">Who Dealt In? (Loser)</label>
            <div class="toggle-group" id="loser-select"></div>
        </div>

        <div class="section">
            <label data-i18n="handValue">Hand Value</label>
            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                <div style="flex: 1;">
                    <label for="han-select" style="display: block; margin-bottom: 5px;" data-i18n="han">Han</label>
                    <select id="han-select" onchange="updateCalculatedScore()" style="width: 100%; padding: 10px; border-radius: 8px; background: #333; color: white; border: 1px solid #555;">
                        <option value="1">1 Han</option>
                        <option value="2">2 Han</option>
                        <option value="3">3 Han</option>
                        <option value="4">4 Han</option>
                        <option value="5">5 Han (Mangan)</option>
                        <option value="6">6-7 Han (Haneman)</option>
                        <option value="8">8-10 Han (Baiman)</option>
                        <option value="11">11-12 Han (Sanbaiman)</option>
                        <option value="13">13+ Han (Yakuman)</option>
                    </select>
                </div>
                <div style="flex: 1;">
                    <label for="fu-select" style="display: block; margin-bottom: 5px;" data-i18n="fu">Fu</label>
                    <select id="fu-select" onchange="updateCalculatedScore()" style="width: 100%; padding: 10px; border-radius: 8px; background: #333; color: white; border: 1px solid #555;">
                        <option value="20">20 Fu</option>
                        <option value="25">25 Fu (7 Pairs)</option>
                        <option value="30">30 Fu</option>
                        <option value="40">40 Fu</option>
                        <option value="50">50 Fu</option>
                        <option value="60">60 Fu</option>
                        <option value="70">70 Fu</option>
                        <option value="80">80 Fu</option>
                        <option value="90">90 Fu</option>
                        <option value="100">100 Fu</option>
                        <option value="110">110 Fu</option>
                    </select>
                </div>
            </div>
            <div class="calculated-score" style="text-align: center; margin-top: 15px; background: #2d2d2d; padding: 10px; border-radius: 8px;">
                <div id="score-breakdown" style="font-size: 1.1rem; color: #aaa; margin-bottom: 4px; min-height: 1.5em; font-family: monospace;"></div>
                <div id="score-total" style="font-size: 2.5rem; font-weight: bold; color: #ffc107; line-height: 1;">0</div>
            </div>
        </div>

        <div class="modal-actions">
            <button class="btn-cancel" onclick="closeModals()" data-i18n="cancel">Cancel</button>
            <button class="btn-confirm" onclick="submitWin()" data-i18n="confirmWin">Confirm Win</button>
        </div>
    </div>
</div>

<!-- Draw Modal -->
<div id="draw-modal" class="modal hidden">
    <div class="modal-content">
        <h2 data-i18n="drawTitle">Draw (Ryuukyoku)</h2>
        <p data-i18n="tenpaiSelect">Select players who are <strong>Tenpai</strong>:</p>
        
        <div class="tenpai-selection" id="tenpai-select"></div>

        <div class="modal-actions">
            <button class="btn-cancel" onclick="closeModals()" data-i18n="cancel">Cancel</button>
            <button class="btn-confirm" onclick="submitDraw()" data-i18n="confirmDraw">Confirm Draw</button>
        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>